# Kubernetes

## POD (некий аналог docker-compose.yaml)

`Основная логическая единица в виде группы контейнеров запускаемых как единое целое.`

## Кластер

### Master-node

`Может быть одна или несколько.`

`Упаравляется через Kube-ctl.`

- Сервисы работающие на Master-node называются **Control-plane**.
- Нода используется только для административных задач (не запускает контейнеры).
- Выполняются основные операции кластеоа.
- Обрабатываются события кластера.

`Минимальный набор компонентов:`

- **Kube-APIServer** (REST/JRPC для управления кластером):
- - Точка входа для всех запросов в кластер.
- - Обрабатывает все запросы и обновляет информацию в etcd.
- - Выполняет аутентификацию и авторизацию клиентов.

- **Kube-Controller-MAnager** (Поддержка состояния кластера):
- - Сервис, включающий в себя множество других сервисов, таких как:
- - - **node controller**                - обнаружение и контролирование нод.
- - - **replication controller**         - поддерживает нужное количество контейнеров приложения.
- - - **endpoints controller**           - обслуживает объекты Endpoints.
- - - **accaunts and tokens controller** - управление аккаунтами и токенам.
- - Проверяет состояние кластера через API-сервер и выполняет необходимые изменения.

- **Kube-Scheduler** (Решает, где запускать контейнер):
- - Получает список всех рабочих нод кластера.
- - Скоринг (оценивает ноды по множеству параметров).
- - Выбирает лучшую и записывает это в API.

- **ETCD** (Key/Value хранилище данных):
- - Распределённая и высоконадёжная БД.
- - Хранит состояние кластера.
- - Может быть в виде одного инстанса или кластер из нескольких реплик.

### Worker-node

`Виртуалки или физические сервера.`

- **RunTime** (Среды взаимодействия с контейренами):
- - Docker.
- - Containerd.
- - CRI-O.

- **Kubelet** (Управляет жизнненым циклом контейнера)
- - Общается с Docker (или другой системой контейнеризации) через API для управления онтейнерами.
- - Передаёт информацию о статусе обратно в API-сервер.
- - Мониторит состояние контейнеров.

- **Kube-proxy** (Конфигурирует правила сети на узлах).